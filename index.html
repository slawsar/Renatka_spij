<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>≈öpij S≈Çoneczko | RelaksujƒÖca aplikacja do zasypiania</title>
    <!-- Favicon -->
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <!-- Bootstrap CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- Dodatkowe ikony -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- Preload plik√≥w audio dla szybszego ≈Çadowania -->
    <link rel="preload" href="sounds/ocean.wav" as="audio">
    <link rel="preload" href="sounds/rain.mp3" as="audio">
    <link rel="preload" href="sounds/forest.mp3" as="audio">
    <link rel="preload" href="sounds/night.mp3" as="audio">
    <link rel="preload" href="sounds/whitenoise.wav" as="audio">
    <link rel="preload" href="sounds/dziubasek.mp3" as="audio">
    
    <style>
        /* G≈Ç√≥wna kolorystyka i og√≥lne stylowanie */
        :root {
            /* Podstawowe kolory */
            --primary-dark: #0a1128;
            --primary-medium: #1c2541;
            --primary-light: #3a506b;
            --accent: #5bc0be;
            --accent-dark: #3a8a88;
            --text-light: #e9ecef;
            
            /* Przezroczyste warianty kolor√≥w */
            --accent-transparent-light: rgba(91, 192, 190, 0.2);
            --accent-transparent-medium: rgba(91, 192, 190, 0.5);
            --accent-transparent-strong: rgba(91, 192, 190, 0.7);
            --white-transparent-light: rgba(255, 255, 255, 0.05);
            --white-transparent-medium: rgba(255, 255, 255, 0.4);
            --white-transparent-strong: rgba(255, 255, 255, 0.7);
            --black-transparent-light: rgba(0, 0, 0, 0.1);
            --black-transparent-medium: rgba(0, 0, 0, 0.3);
            --black-transparent-strong: rgba(0, 0, 0, 0.5);
            
            /* System cieni */
            --shadow-sm: 0 2px 5px rgba(0, 0, 0, 0.2);
            --shadow-md: 0 4px 15px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 8px 25px rgba(0, 0, 0, 0.4);
            
            /* System zaokrƒÖgle≈Ñ */
            --radius-sm: 8px;
            --radius-md: 10px;
            --radius-lg: 15px;
            
            /* Czas trwania przej≈õƒá */
            --transition-speed: 0.3s ease;
        }
        
        body {
            background-color: var(--primary-dark);
            color: var(--text-light);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
            transition: background-color var(--transition-speed);
        }
        
        body.light-mode {
            --primary-dark: #e9f5f9;
            --primary-medium: #c4e0f3;
            --primary-light: #93c5fd;
            --accent: #3b82f6;
            --accent-dark: #2563eb;
            --text-light: #0f172a;
            --accent-transparent-light: rgba(59, 130, 246, 0.2);
            --accent-transparent-medium: rgba(59, 130, 246, 0.5);
            --accent-transparent-strong: rgba(59, 130, 246, 0.7);
            background-color: var(--primary-dark);
            color: var(--text-light);
        }
        
        /* Animowane t≈Ço z gwiazdami */
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }
        
        .star {
            position: absolute;
            background-color: white;
            border-radius: 50%;
            opacity: 0;
            animation: twinkle var(--duration, 4s) infinite var(--delay, 0s);
        }
        
        @keyframes twinkle {
            0% { opacity: 0; }
            50% { opacity: var(--intensity, 1); }
            100% { opacity: 0; }
        }
        
        /* P√≥≈Çprzezroczyste chmury */
        .cloud {
            position: absolute;
            background-color: var(--white-transparent-light);
            border-radius: 50%;
            filter: blur(20px);
            animation: float var(--duration, 60s) infinite linear;
            opacity: 0.3;
        }
        
        @keyframes float {
            0% { transform: translateX(-5%); }
            50% { transform: translateX(5%); }
            100% { transform: translateX(-5%); }
        }
        
        /* G≈Ç√≥wne elementy stylowania */
        .container {
            padding: 2rem 1rem;
            position: relative;
            z-index: 1;
        }
        
        header {
            text-align: center;
            padding: 2rem 0 1rem;
            position: relative;
        }
        
        h1 {
            color: var(--accent);
            font-size: 2.8rem;
            margin-bottom: 0.5rem;
            text-shadow: 0 0 10px var(--accent-transparent-strong);
        }
        
        h2 {
            color: var(--accent);
            font-size: 1.8rem;
            margin: 1.5rem 0;
        }
        
        h3 {
            color: var(--accent);
            font-size: 1.5rem;
        }
        
        .card {
            background-color: var(--primary-medium);
            border: none;
            border-radius: var(--radius-lg);
            margin-bottom: 2rem;
            box-shadow: var(--shadow-md);
            transition: transform var(--transition-speed), box-shadow var(--transition-speed);
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        /* Stylowanie odtwarzacza d≈∫wiƒôku */
        .sound-player {
            padding: 1.5rem;
        }
        
        .sound-btn {
            background-color: var(--primary-light);
            color: var(--text-light);
            border: none;
            border-radius: var(--radius-md);
            padding: 0.8rem 1.2rem;
            margin: 0.5rem;
            transition: all var(--transition-speed);
            box-shadow: var(--shadow-sm);
        }
        
        .sound-btn:hover {
            background-color: var(--accent);
            color: var(--primary-dark);
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
        }
        
        .sound-btn.active {
            background-color: var(--accent);
            color: var(--primary-dark);
            box-shadow: 0 0 10px var(--accent);
        }
        
        .sound-card {
            background-color: var(--primary-light);
            border-radius: var(--radius-md);
            padding: 1rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            opacity: 0.7;
            transition: opacity var(--transition-speed);
        }
        
        .sound-card.active {
            opacity: 1;
            box-shadow: 0 0 10px var(--accent-transparent-medium);
        }
        
        .sound-wave {
            display: flex;
            align-items: flex-end;
            height: 30px;
            width: 50px;
            margin-right: 10px;
        }
        
        .sound-wave.active span {
            animation: soundWave 1s infinite;
        }
        
        .sound-wave span {
            display: inline-block;
            width: 4px;
            margin: 0 2px;
            background-color: var(--accent);
            height: 5px;
            border-radius: 2px;
        }
        
        @keyframes soundWave {
            0%, 100% { height: 5px; }
            50% { height: 20px; }
        }
        
        .sound-wave span:nth-child(1) { animation-delay: 0.1s; }
        .sound-wave span:nth-child(2) { animation-delay: 0.2s; }
        .sound-wave span:nth-child(3) { animation-delay: 0.05s; }
        .sound-wave span:nth-child(4) { animation-delay: 0.3s; }
        .sound-wave span:nth-child(5) { animation-delay: 0.15s; }
        
        .controls {
            margin-top: 2rem;
        }
        
        .slider-container {
            margin: 1.5rem 0;
        }
        
        .form-label {
            color: var(--accent);
            font-weight: 500;
            font-size: 1.1rem;
            margin-bottom: 0.8rem;
        }
        
        .form-range::-webkit-slider-thumb {
            background: var(--accent);
        }
        
        .form-range::-moz-range-thumb {
            background: var(--accent);
        }
        
        /* Stylowanie timera */
        .timer-container {
            text-align: center;
            margin: 1.5rem 0;
        }
        
        .timer-display {
            font-size: 2.2rem;
            font-weight: bold;
            margin: 1rem 0;
            color: var(--accent);
            text-shadow: 0 0 5px var(--accent-transparent-medium);
        }
        
        .custom-timer-container {
            margin-top: 1rem;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .custom-timer-input {
            width: 80px;
            background-color: var(--primary-medium);
            border: 2px solid var(--accent);
            border-radius: var(--radius-sm);
            color: var(--text-light);
            padding: 0.4rem;
            margin-right: 0.5rem;
            text-align: center;
        }
        
        /* Stylowanie dla ƒáwicze≈Ñ relaksacyjnych */
        .relaxation-exercise {
            text-align: center;
            padding: 1.5rem 0;
        }
        
        .breathing-exercise {
            text-align: center;
            padding: 1.5rem 0;
        }
        
        #breathing-description {
            color: var(--text-light);
            font-weight: 500;
            margin-bottom: 1.2rem;
        }
        
        .breathing-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            margin: 0 auto;
            background-color: var(--accent-transparent-light);
            border: 3px solid var(--accent);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: transform var(--transition-speed), background-color var(--transition-speed);
        }
        
        .breathing-circle.inhale {
            animation: inhale 4s forwards;
        }
        
        .breathing-circle.hold {
            animation: hold 7s forwards;
        }
        
        .breathing-circle.exhale {
            animation: exhale 8s forwards;
        }
        
        .breathing-circle.box-inhale {
            animation: inhale 4s forwards;
        }
        
        .breathing-circle.box-hold1 {
            animation: hold 4s forwards;
        }
        
        .breathing-circle.box-exhale {
            animation: exhale 4s forwards;
        }
        
        .breathing-circle.box-hold2 {
            animation: hold 4s forwards;
        }
        
        .muscle-relaxation-section {
            margin-top: 1.5rem;
            padding: 1rem;
            border-radius: var(--radius-md);
            background-color: var(--primary-light);
            text-align: left;
        }
        
        .muscle-group {
            padding: 1.2rem;
            margin-bottom: 1rem;
            border-radius: var(--radius-sm);
            background-color: var(--primary-medium);
            position: relative;
            cursor: pointer;
            transition: background-color var(--transition-speed);
        }
        
        .muscle-group h4 {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--accent);
            text-shadow: 0 1px 2px var(--black-transparent-light);
        }
        
        .muscle-group:hover {
            background-color: var(--primary-light);
        }
        
        .muscle-group.active {
            background-color: var(--accent-dark);
        }
        
        .muscle-group.active h4 {
            color: white;
            text-shadow: 0 1px 2px var(--black-transparent-medium);
        }
        
        .muscle-instruction {
            display: none;
            padding: 1.2rem;
            margin-top: 0.7rem;
            border-radius: var(--radius-sm);
            background-color: var(--accent-transparent-light);
            border-left: 4px solid var(--accent);
            font-size: 1.1rem;
            line-height: 1.6;
            color: var(--text-light);
            font-weight: 500;
        }
        
        .muscle-instruction.visible {
            display: block;
        }
        
        .muscle-instruction p {
            margin-bottom: 0.7rem;
            text-shadow: 0 1px 1px var(--black-transparent-light);
        }
        
        .relaxation-progress {
            height: 10px;
            background-color: var(--primary-medium);
            border-radius: 5px;
            margin: 1rem 0;
            overflow: hidden;
        }
        
        .relaxation-progress-bar {
            height: 100%;
            background-color: var(--accent);
            width: 0;
            transition: width var(--transition-speed);
        }
        
        .visualization-scene {
            position: relative;
            height: 200px;
            border-radius: var(--radius-md);
            overflow: hidden;
            margin: 1.5rem 0;
            background-size: cover;
            background-position: center;
        }
        
        .visualization-beach {
            background-image: linear-gradient(to bottom, #87CEEB, #1E90FF);
        }
        
        .visualization-forest {
            background-image: linear-gradient(to bottom, #228B22, #006400);
        }
        
        .visualization-sky {
            background-image: linear-gradient(to bottom, #4169E1, #191970);
        }
        
        .visualization-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-shadow: 1px 1px 3px var(--black-transparent-strong);
            padding: 1rem;
            background-color: var(--black-transparent-light);
        }
        
        .visualization-text {
            font-size: 1.2rem;
            max-width: 80%;
            text-align: center;
        }
        
        .exercise-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 1rem;
        }
        
        .nav-btn {
            background-color: var(--primary-light);
            color: var(--text-light);
            border: none;
            border-radius: var(--radius-sm);
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: all var(--transition-speed);
        }
        
        .nav-btn:hover {
            background-color: var(--accent);
            color: var(--primary-dark);
        }
        
        .exercise-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        
        .exercise-tab {
            padding: 0.7rem 1.2rem;
            margin: 0.3rem;
            background-color: var(--primary-light);
            color: var(--text-light);
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all var(--transition-speed);
        }
        
        .exercise-tab.active {
            background-color: var(--accent);
            color: var(--primary-dark);
        }
        
        .exercise-content {
            display: none;
        }
        
        .exercise-content.active {
            display: block;
        }
        
        /* Stylowanie opis√≥w ƒáwicze≈Ñ */
        .exercise-intro {
            font-size: 1.15rem;
            line-height: 1.7;
            color: var(--text-light);
            padding: 1rem;
            margin-bottom: 1.5rem;
            font-weight: 500;
            background-color: var(--accent-transparent-light);
            border-radius: var(--radius-sm);
            border-left: 4px solid var(--accent);
            text-shadow: 0 1px 2px var(--black-transparent-light);
        }
        
        @keyframes inhale {
            from { transform: scale(1); background-color: var(--accent-transparent-light); }
            to { transform: scale(1.5); background-color: var(--accent-transparent-medium); }
        }
        
        @keyframes hold {
            from { transform: scale(1.5); background-color: var(--accent-transparent-medium); }
            to { transform: scale(1.5); background-color: var(--accent-transparent-medium); }
        }
        
        @keyframes exhale {
            from { transform: scale(1.5); background-color: var(--accent-transparent-medium); }
            to { transform: scale(1); background-color: var(--accent-transparent-light); }
        }
        
        /* Animacja fali dla wizualizacji pla≈ºy */
        .wave {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 20px;
            background: var(--white-transparent-medium);
            border-radius: 50% 50% 0 0;
            animation: wave 8s infinite linear;
        }
        
        .wave:nth-child(2) {
            height: 15px;
            bottom: 10px;
            opacity: 0.6;
            animation-delay: 0.5s;
        }
        
        .wave:nth-child(3) {
            height: 10px;
            bottom: 15px;
            opacity: 0.4;
            animation-delay: 1s;
        }
        
        @keyframes wave {
            0% { transform: translateX(-50%); }
            100% { transform: translateX(50%); }
        }
        
        /* Sekcja porad dotyczƒÖcych snu */
        .sleep-tips {
            padding: 1.5rem;
        }
        
        .tip-item {
            margin-bottom: 1.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--primary-light);
        }
        
        .tip-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .tip-item p {
            color: var(--text-light);
            font-size: 1rem;
            line-height: 1.6;
        }
        
        .tip-item h4 {
            color: var(--accent);
            font-size: 1.2rem;
            margin-bottom: 0.8rem;
            font-weight: 600;
        }
        
        .tip-icon {
            color: var(--accent);
            margin-right: 0.5rem;
        }
        
        /* Prze≈ÇƒÖcznik trybu jasny/ciemny */
        .theme-toggle {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: var(--accent);
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 10;
            transition: transform var(--transition-speed);
        }
        
        .theme-toggle:hover {
            transform: rotate(30deg);
        }
        
        /* Stopka */
        footer {
            text-align: center;
            padding: 1.5rem 0;
            margin-top: 1rem;
            color: var(--text-light);
            opacity: 0.7;
        }
        
        /* Animacja ksiƒô≈ºyca */
        .moon {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 50px;
            height: 50px;
            background-color: var(--white-transparent-strong);
            border-radius: 50%;
            box-shadow: 0 0 20px var(--white-transparent-strong);
            z-index: 0;
            transition: background-color var(--transition-speed), box-shadow var(--transition-speed);
        }
        
        .light-mode .moon {
            background-color: #fbbf24;
            box-shadow: 0 0 30px rgba(251, 191, 36, 0.7);
        }
        
        /* Toast powiadomienia */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .custom-toast {
            background-color: var(--primary-medium);
            color: var(--text-light);
            border-left: 4px solid var(--accent);
            box-shadow: var(--shadow-md);
        }
        
        /* Responsywno≈õƒá */
        @media (max-width: 768px) {
            h1 {
                font-size: 2.2rem;
            }
            
            h2 {
                font-size: 1.5rem;
            }
            
            .sound-btn {
                padding: 0.6rem 1rem;
                margin: 0.3rem;
                font-size: 0.9rem;
            }
            
            .timer-display {
                font-size: 1.8rem;
            }
            
            .moon {
                width: 40px;
                height: 40px;
                top: 15px;
                left: 15px;
            }
            
            .breathing-circle {
                width: 120px;
                height: 120px;
            }
        }
    </style>
</head>
<body>
    <!-- T≈Ço z gwiazdami i chmurami -->
    <div class="stars" id="stars"></div>
    <div class="moon"></div>
    
    <!-- Toast powiadomienia -->
    <div class="toast-container">
        <div class="toast custom-toast" role="alert" aria-live="assertive" aria-atomic="true" id="app-toast">
            <div class="toast-header">
                <strong class="me-auto" id="toast-title">Powiadomienie</strong>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body" id="toast-message">
                Wiadomo≈õƒá
            </div>
        </div>
    </div>
    
    <div class="container">
        <!-- Prze≈ÇƒÖcznik trybu jasny/ciemny -->
        <button class="theme-toggle" id="theme-toggle" title="Zmie≈Ñ motyw">
            <i class="fas fa-moon" id="theme-icon"></i>
        </button>
        
        <!-- Nag≈Ç√≥wek -->
        <header>
            <h1>≈öpij S≈Çoneczko</h1>
            <p class="lead">RelaksujƒÖca aplikacja stworzona przez dziubaska dla Renatki</p>
        </header>
        
        <!-- G≈Ç√≥wna zawarto≈õƒá -->
        <main>
            <!-- Odtwarzacz d≈∫wiƒôk√≥w i timer -->
            <div class="card sound-player">
                <div class="card-body">
                    <h2><i class="fas fa-music"></i> RelaksujƒÖce d≈∫wiƒôki</h2>
                    
                    <!-- Przyciski d≈∫wiƒôk√≥w -->
                    <div class="d-flex flex-wrap justify-content-center mb-4">
                        <button class="sound-btn" data-sound="ocean"><i class="fas fa-water"></i> Szum morza</button>
                        <button class="sound-btn" data-sound="rain"><i class="fas fa-cloud-rain"></i> Deszcz</button>
                        <button class="sound-btn" data-sound="forest"><i class="fas fa-tree"></i> Las</button>
                        <button class="sound-btn" data-sound="night"><i class="fas fa-moon"></i> Noc</button>
                        <button class="sound-btn" data-sound="whitenoise"><i class="fas fa-wave-square"></i> Bia≈Çy szum</button>
                        <button class="sound-btn" data-sound="dziubasek"><i class="fas fa-heart"></i> Dziubasek</button>
                    </div>
                    
                    <!-- Wizualizacja aktywnych d≈∫wiƒôk√≥w -->
                    <div class="active-sounds my-3" id="active-sounds-container">
                        <!-- Aktywne d≈∫wiƒôki bƒôdƒÖ dodawane tutaj dynamicznie -->
                    </div>
                    
                    <div class="controls">
                        <!-- Kontrola g≈Ço≈õno≈õci -->
                        <div class="slider-container">
                            <label for="volume" class="form-label"><i class="fas fa-volume-up"></i> G≈Ço≈õno≈õƒá</label>
                            <input type="range" class="form-range" id="volume" min="0" max="1" step="0.01" value="0.5">
                        </div>
                        
                        <!-- Timer -->
                        <div class="timer-container">
                            <h3><i class="fas fa-clock"></i> Timer snu</h3>
                            <div class="timer-display" id="timer-display">00:00:00</div>
                            <div class="d-flex flex-wrap justify-content-center">
                                <button class="sound-btn timer-btn" data-time="5">5 min</button>
                                <button class="sound-btn timer-btn" data-time="15">15 min</button>
                                <button class="sound-btn timer-btn" data-time="30">30 min</button>
                                <button class="sound-btn timer-btn" data-time="60">1 godz</button>
                                <button class="sound-btn timer-btn" data-time="0"><i class="fas fa-stop"></i> Wy≈ÇƒÖcz</button>
                            </div>
                            
                            <!-- Niestandardowy timer -->
                            <div class="custom-timer-container mt-3">
                                <input type="number" min="1" max="480" class="custom-timer-input" id="custom-timer-input" placeholder="min">
                                <button class="sound-btn" id="custom-timer-btn"><i class="fas fa-check"></i> Ustaw</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Rozbudowane ƒáwiczenia relaksacyjne -->
            <div class="card relaxation-exercises">
                <div class="card-body">
                    <h2><i class="fas fa-spa"></i> ƒÜwiczenia relaksacyjne</h2>
                    
                    <div class="exercise-tabs">
                        <button class="exercise-tab active" data-tab="breathing"><i class="fas fa-lungs"></i> Techniki oddechowe</button>
                        <button class="exercise-tab" data-tab="muscle"><i class="fas fa-walking"></i> Relaksacja miƒô≈õni</button>
                        <button class="exercise-tab" data-tab="visualization"><i class="fas fa-cloud-sun"></i> Wizualizacje</button>
                    </div>
                    
                    <!-- Techniki oddechowe -->
                    <div class="exercise-content active" id="breathing-content">
                        <div class="exercise-tabs">
                            <button class="exercise-tab active" data-breathing="478"><i class="fas fa-wind"></i> Technika 4-7-8</button>
                            <button class="exercise-tab" data-breathing="box"><i class="fas fa-square"></i> Oddychanie kwadratowe 4-4-4-4</button>
                            <button class="exercise-tab" data-breathing="diaphragm"><i class="fas fa-circle"></i> Oddychanie przeponowe</button>
                        </div>
                        
                        <div class="breathing-exercise">
                            <p id="breathing-description">Technika 4-7-8 pomaga zrelaksowaƒá siƒô i przygotowaƒá do snu</p>
                            <div class="breathing-circle" id="breathing-circle">
                                <span id="breathing-text">Kliknij, aby rozpoczƒÖƒá</span>
                            </div>
                            <button class="sound-btn mt-4" id="start-breathing-btn">Rozpocznij ƒáwiczenie</button>
                        </div>
                    </div>
                    
                    <!-- Progresywna relaksacja miƒô≈õni -->
                    <div class="exercise-content" id="muscle-content">
                        <p class="exercise-intro">Progresywna relaksacja miƒô≈õni polega na naprzemiennym napinaniu i rozlu≈∫nianiu poszczeg√≥lnych grup miƒô≈õni. Wykonuj to ƒáwiczenie w wygodnej pozycji, najlepiej le≈ºƒÖcej.</p>
                        
                        <div class="relaxation-progress">
                            <div class="relaxation-progress-bar" id="muscle-progress"></div>
                        </div>
                        
                        <div class="muscle-relaxation-section">
                            <div class="muscle-group" data-group="hands">
                                <h4><i class="fas fa-hand-paper"></i> D≈Çonie i przedramiona</h4>
                                <div class="muscle-instruction">
                                    <p>1. Zaci≈õnij d≈Çonie w piƒô≈õci tak mocno, jak mo≈ºesz</p>
                                    <p>2. Utrzymaj napiƒôcie przez 5 sekund</p>
                                    <p>3. Powoli rozlu≈∫nij d≈Çonie, czujƒÖc jak napiƒôcie odp≈Çywa</p>
                                    <p>4. Odpoczywaj przez 10 sekund, skupiajƒÖc siƒô na uczuciu rozlu≈∫nienia</p>
                                </div>
                            </div>
                            
                            <div class="muscle-group" data-group="arms">
                                <h4><i class="fas fa-running"></i> Ramiona i bicepsy</h4>
                                <div class="muscle-instruction">
                                    <p>1. Zegnij rƒôce w ≈Çokciach i napnij bicepsy</p>
                                    <p>2. Utrzymaj napiƒôcie przez 5 sekund</p>
                                    <p>3. Powoli rozlu≈∫nij miƒô≈õnie, pozwalajƒÖc ramionom opa≈õƒá swobodnie</p>
                                    <p>4. Odpoczywaj przez 10 sekund, zauwa≈ºajƒÖc r√≥≈ºnicƒô miƒôdzy napiƒôciem a rozlu≈∫nieniem</p>
                                </div>
                            </div>
                            
                            <div class="muscle-group" data-group="shoulders">
                                <h4><i class="fas fa-user"></i> Barki i kark</h4>
                                <div class="muscle-instruction">
                                    <p>1. Podnie≈õ barki w kierunku uszu (jak przy wzruszaniu ramionami)</p>
                                    <p>2. Utrzymaj napiƒôcie przez 5 sekund</p>
                                    <p>3. Powoli opu≈õƒá barki, pozwalajƒÖc im ca≈Çkowicie opa≈õƒá</p>
                                    <p>4. Odpoczywaj przez 10 sekund, skupiajƒÖc siƒô na cieple rozchodzƒÖcym siƒô po barkach</p>
                                </div>
                            </div>
                            
                            <div class="muscle-group" data-group="face">
                                <h4><i class="fas fa-smile"></i> Twarz i szczƒôka</h4>
                                <div class="muscle-instruction">
                                    <p>1. Zaci≈õnij szczƒôkƒô, napnij usta i zmru≈º mocno oczy</p>
                                    <p>2. Utrzymaj napiƒôcie przez 5 sekund</p>
                                    <p>3. Powoli rozlu≈∫nij wszystkie miƒô≈õnie twarzy</p>
                                    <p>4. Odpoczywaj przez 10 sekund, pozwalajƒÖc twarzy byƒá ca≈Çkowicie rozlu≈∫nionƒÖ</p>
                                </div>
                            </div>
                            
                            <div class="muscle-group" data-group="chest">
                                <h4><i class="fas fa-lungs"></i> Klatka piersiowa i brzuch</h4>
                                <div class="muscle-instruction">
                                    <p>1. We≈∫ g≈Çƒôboki wdech i napnij miƒô≈õnie brzucha</p>
                                    <p>2. Utrzymaj napiƒôcie przez 5 sekund</p>
                                    <p>3. Powoli wydychaj powietrze, rozlu≈∫niajƒÖc miƒô≈õnie</p>
                                    <p>4. Odpoczywaj przez 10 sekund, oddychajƒÖc naturalnie</p>
                                </div>
                            </div>
                            
                            <div class="muscle-group" data-group="legs">
                                <h4><i class="fas fa-shoe-prints"></i> Nogi i stopy</h4>
                                <div class="muscle-instruction">
                                    <p>1. Napnij uda, ≈Çydki i stopy, podciƒÖgajƒÖc palce st√≥p do g√≥ry</p>
                                    <p>2. Utrzymaj napiƒôcie przez 5 sekund</p>
                                    <p>3. Powoli rozlu≈∫nij wszystkie miƒô≈õnie n√≥g</p>
                                    <p>4. Odpoczywaj przez 10 sekund, czujƒÖc ciƒô≈ºar rozlu≈∫nionych n√≥g</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="text-center mt-4">
                            <button class="sound-btn" id="start-muscle-relaxation">Rozpocznij pe≈Çne ƒáwiczenie</button>
                        </div>
                    </div>
                    
                    <!-- Wizualizacje relaksacyjne -->
                    <div class="exercise-content" id="visualization-content">
                        <p class="exercise-intro">Wybierz scenƒô do wizualizacji. Zamknij oczy, s≈Çuchaj opisu i spr√≥buj wyobraziƒá sobie to miejsce wszystkimi zmys≈Çami.</p>
                        
                        <div class="exercise-tabs">
                            <button class="exercise-tab active" data-scene="beach"><i class="fas fa-umbrella-beach"></i> Pla≈ºa</button>
                            <button class="exercise-tab" data-scene="forest"><i class="fas fa-tree"></i> Las</button>
                            <button class="exercise-tab" data-scene="sky"><i class="fas fa-cloud-moon"></i> Rozgwie≈ºd≈ºone niebo</button>
                        </div>
                        
                        <div class="visualization-scene visualization-beach" id="visualization-scene">
                            <div class="wave"></div>
                            <div class="wave"></div>
                            <div class="wave"></div>
                            <div class="visualization-overlay">
                                <p class="visualization-text" id="visualization-text">
                                    Wyobra≈∫ sobie, ≈ºe le≈ºysz na ciep≈Çej, miƒôkkiej pla≈ºy. S≈Ço≈Ñce delikatnie ogrzewa twojƒÖ sk√≥rƒô.
                                    S≈Çyszysz rytmiczny szum fal, kt√≥re ≈Çagodnie uderzajƒÖ o brzeg...
                                </p>
                            </div>
                        </div>
                        
                        <div class="text-center mt-3">
                            <button class="sound-btn" id="start-visualization">Rozpocznij wizualizacjƒô</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Porady dotyczƒÖce snu -->
            <div class="card sleep-tips">
                <div class="card-body">
                    <h2><i class="fas fa-bed"></i> Porady dla lepszego snu</h2>
                    <div class="tip-item">
                        <h4><i class="fas fa-calendar-alt tip-icon"></i> Regularne godziny snu</h4>
                        <p>Staraj siƒô chodziƒá spaƒá i budziƒá siƒô o tej samej porze ka≈ºdego dnia, nawet w weekendy. To pomaga w regulacji twojego wewnƒôtrznego zegara biologicznego.</p>
                    </div>
                    <div class="tip-item">
                        <h4><i class="fas fa-mobile-alt tip-icon"></i> Unikaj niebieskiego ≈õwiat≈Ça</h4>
                        <p>Ogranicz korzystanie z urzƒÖdze≈Ñ elektronicznych (telefon, tablet, laptop) co najmniej godzinƒô przed snem. Niebieskie ≈õwiat≈Ço emitowane przez te urzƒÖdzenia mo≈ºe zak≈Ç√≥caƒá produkcjƒô melatoniny.</p>
                    </div>
                    <div class="tip-item">
                        <h4><i class="fas fa-spa tip-icon"></i> Stw√≥rz rytua≈Ç przed snem</h4>
                        <p>Rozwijaj rytua≈Çy, kt√≥re sygnalizujƒÖ twojemu cia≈Çu, ≈ºe czas siƒô zrelaksowaƒá. Mo≈ºe to byƒá czytanie ksiƒÖ≈ºki, ciep≈Ça kƒÖpiel, medytacja lub s≈Çuchanie kojƒÖcej muzyki.</p>
                    </div>
                    <div class="tip-item">
                        <h4><i class="fas fa-mug-hot tip-icon"></i> Pij zio≈Çowe herbaty przed snem</h4>
                        <p>Ciep≈Çe zio≈Çowe napary, takie jak melisa, rumianek, lawenda czy lipa, pomagajƒÖ siƒô zrelaksowaƒá i przygotowaƒá cia≈Ço do snu. Wypijaj fili≈ºankƒô oko≈Ço godzinƒô przed planowanym czasem snu.</p>
                    </div>
                    <div class="tip-item">
                        <h4><i class="fas fa-temperature-low tip-icon"></i> Komfortowa sypialnia</h4>
                        <p>Upewnij siƒô, ≈ºe twoja sypialnia jest ciemna, cicha i ma odpowiedniƒÖ temperaturƒô (18-20¬∞C). Wygodny materac i poduszki r√≥wnie≈º sƒÖ wa≈ºne dla jako≈õci snu.</p>
                    </div>
                    <div class="tip-item">
                        <h4><i class="fas fa-headphones tip-icon"></i> Personalizuj d≈∫wiƒôki do zasypiania</h4>
                        <p>Wybieraj d≈∫wiƒôki, kt√≥re osobi≈õcie dzia≈ÇajƒÖ na Ciebie uspokajajƒÖco. Mo≈ºesz nagraƒá swoje ulubione odg≈Çosy natury podczas spaceru, szum morza z wakacji, czy nawet znajome d≈∫wiƒôki domowe, kt√≥re kojarzƒÖ Ci siƒô z bezpiecze≈Ñstwem i spokojem.</p>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- Stopka -->
        <footer>
            <p>¬© 2025 ≈öpij S≈Çoneczko | Stworzone z mi≈Ço≈õciƒÖ przez dziubaska dla Renatki üíùüåûüíù</p>
            <p><a href="#" id="save-preferences" class="text-decoration-none" style="color: var(--accent)">Zapisz preferencje</a></p>
        </footer>
    </div>
    
    <!-- Szablony HTML -->
    <template id="sound-card-template">
        <div class="sound-card mb-2">
            <div class="d-flex align-items-center">
                <div class="sound-wave me-2">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <span class="sound-name"></span>
            </div>
            <div>
                <input type="range" class="form-range individual-volume" min="0" max="1" step="0.01" value="0.5" style="width: 100px;">
                <button class="btn-close sound-close ms-2" aria-label="Close"></button>
            </div>
        </div>
    </template>
    
    <!-- Bootstrap JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    
    <!-- G≈Ç√≥wny skrypt JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Inicjalizacja tooltip√≥w Bootstrap
            const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            tooltipTriggerList.map(function (tooltipTriggerEl) {
                return new bootstrap.Tooltip(tooltipTriggerEl);
            });
            
            // Inicjalizacja toast√≥w
            const toastEl = document.getElementById('app-toast');
            const toast = new bootstrap.Toast(toastEl, {
                autohide: true,
                delay: 3000
            });
            
            // Funkcja do pokazywania powiadomie≈Ñ
            function showToast(title, message) {
                document.getElementById('toast-title').textContent = title;
                document.getElementById('toast-message').textContent = message;
                toast.show();
            }
            
            // Tworzenie gwiazd dla animowanego t≈Ça
            const starsContainer = document.getElementById('stars');
            const starsCount = 150; // Liczba gwiazd
            
            // Tworzenie gwiazd
            for (let i = 0; i < starsCount; i++) {
                const star = document.createElement('div');
                star.classList.add('star');
                
                // Losowa pozycja
                star.style.left = `${Math.random() * 100}%`;
                star.style.top = `${Math.random() * 100}%`;
                
                // Losowy rozmiar (1-3px)
                const size = Math.random() * 2 + 1;
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                
                // Losowa intensywno≈õƒá blasku
                star.style.setProperty('--intensity', 0.2 + Math.random() * 0.8);
                
                // Losowe op√≥≈∫nienie i czas trwania animacji
                star.style.setProperty('--delay', `${Math.random() * 4}s`);
                star.style.setProperty('--duration', `${3 + Math.random() * 5}s`);
                
                starsContainer.appendChild(star);
            }
            
            // Dodanie kilku przesuwajƒÖcych siƒô chmur
            for (let i = 0; i < 5; i++) {
                const cloud = document.createElement('div');
                cloud.classList.add('cloud');
                
                // Losowa pozycja
                cloud.style.left = `${Math.random() * 100}%`;
                cloud.style.top = `${Math.random() * 100}%`;
                
                // Losowy rozmiar
                const size = 100 + Math.random() * 200;
                cloud.style.width = `${size}px`;
                cloud.style.height = `${size / 2}px`;
                
                // Losowe op√≥≈∫nienie i czas trwania animacji
                cloud.style.setProperty('--duration', `${50 + Math.random() * 30}s`);
                
                starsContainer.appendChild(cloud);
            }
            
            // ========== PRZE≈ÅƒÑCZNIK TRYBU JASNY/CIEMNY ==========
            const themeToggle = document.getElementById('theme-toggle');
            const themeIcon = document.getElementById('theme-icon');
            
            // Sprawd≈∫, czy u≈ºytkownik ma zapisane preferencje
            const savedTheme = localStorage.getItem('spijSloneczko-theme');
            if (savedTheme === 'light') {
                document.body.classList.add('light-mode');
                themeIcon.classList.remove('fa-moon');
                themeIcon.classList.add('fa-sun');
            }
            
            themeToggle.addEventListener('click', function() {
                document.body.classList.toggle('light-mode');
                
                if (document.body.classList.contains('light-mode')) {
                    themeIcon.classList.remove('fa-moon');
                    themeIcon.classList.add('fa-sun');
                    localStorage.setItem('spijSloneczko-theme', 'light');
                } else {
                    themeIcon.classList.remove('fa-sun');
                    themeIcon.classList.add('fa-moon');
                    localStorage.setItem('spijSloneczko-theme', 'dark');
                }
            });
            
            // ========== SYSTEM ODTWARZANIA D≈πWIƒòK√ìW ==========
            
            // Pobranie element√≥w DOM
            const soundButtons = document.querySelectorAll('.sound-btn[data-sound]');
            const volumeSlider = document.getElementById('volume');
            const timerButtons = document.querySelectorAll('.timer-btn');
            const timerDisplay = document.getElementById('timer-display');
            const customTimerInput = document.getElementById('custom-timer-input');
            const customTimerBtn = document.getElementById('custom-timer-btn');
            const activeContainer = document.getElementById('active-sounds-container');
            const soundCardTemplate = document.getElementById('sound-card-template');
            
            // Timer
            let timerInterval = null;
            let timerEndTime = null;
            
            // Przechowywanie aktywnych d≈∫wiƒôk√≥w (jako mapa)
            const activeSounds = new Map();
            
            // ===== KONFIGURACJA D≈πWIƒòK√ìW =====
            const sounds = {
                'ocean': 'sounds/ocean.wav',
                'rain': 'sounds/rain.mp3',
                'forest': 'sounds/forest.mp3',
                'night': 'sounds/night.mp3',
                'whitenoise': 'sounds/whitenoise.wav',
                'dziubasek': 'sounds/dziubasek.mp3'
            };
            
            // Mapowanie nazw d≈∫wiƒôk√≥w na przyjazne nazwy polskie
            const soundNames = {
                'ocean': 'Szum morza',
                'rain': 'Deszcz',
                'forest': 'Las',
                'night': 'Noc',
                'whitenoise': 'Bia≈Çy szum',
                'dziubasek': 'Dziubasek'
            };
            
            // Mapowanie nazw d≈∫wiƒôk√≥w na ikony
            const soundIcons = {
                'ocean': 'fa-water',
                'rain': 'fa-cloud-rain',
                'forest': 'fa-tree',
                'night': 'fa-moon',
                'whitenoise': 'fa-wave-square',
                'dziubasek': 'fa-heart'
            };
            
            // Funkcja tworzƒÖca element karty d≈∫wiƒôku
            function createSoundCard(soundName, audio) {
                const template = soundCardTemplate.content.cloneNode(true);
                const card = template.querySelector('.sound-card');
                card.dataset.sound = soundName;
                
                // Ustaw nazwƒô d≈∫wiƒôku
                const nameElement = card.querySelector('.sound-name');
                nameElement.textContent = soundNames[soundName] || soundName;
                
                // Dodaj ikonƒô
                const iconClass = soundIcons[soundName];
                if (iconClass) {
                    const icon = document.createElement('i');
                    icon.className = `fas ${iconClass} me-2`;
                    nameElement.prepend(icon);
                }
                
                // Ustaw klasƒô aktywnƒÖ dla wizualizacji d≈∫wiƒôku
                card.classList.add('active');
                const soundWave = card.querySelector('.sound-wave');
                soundWave.classList.add('active');
                
                // Obs≈Çuga indywidualnej g≈Ço≈õno≈õci
                const volumeControl = card.querySelector('.individual-volume');
                volumeControl.value = audio.volume;
                volumeControl.addEventListener('input', function() {
                    audio.volume = parseFloat(this.value);
                });
                
                // Obs≈Çuga przycisku zamykania
                const closeBtn = card.querySelector('.sound-close');
                closeBtn.addEventListener('click', function() {
                    stopSound(soundName);
                });
                
                return card;
            }
            
            // Funkcja odtwarzania d≈∫wiƒôku
            function playSound(soundName) {
                // Je≈õli d≈∫wiƒôk jest ju≈º odtwarzany, zatrzymaj go
                if (activeSounds.has(soundName)) {
                    stopSound(soundName);
                    return;
                }
                
                try {
                    // Sprawd≈∫, czy ≈õcie≈ºka do d≈∫wiƒôku istnieje
                    if (!sounds[soundName]) {
                        showToast("B≈ÇƒÖd", `Brak pliku d≈∫wiƒôkowego dla: ${soundName}`);
                        return;
                    }
                    
                    // Utw√≥rz element audio
                    const audio = new Audio(sounds[soundName]);
                    
                    // Ustawienia
                    audio.loop = true; // Zapƒôtlenie d≈∫wiƒôku
                    
                    // Pobierz aktualnƒÖ warto≈õƒá g≈Ço≈õno≈õci z suwaka
                    const volume = parseFloat(volumeSlider.value);
                    audio.volume = volume;
                    
                    // Obs≈Çuga b≈Çƒôd√≥w ≈Çadowania pliku
                    audio.onerror = function() {
                        showToast("B≈ÇƒÖd", `Nie mo≈ºna za≈Çadowaƒá pliku: ${sounds[soundName]}`);
                    };
                    
                    // Rozpocznij odtwarzanie
                    audio.play().catch(err => {
                        showToast("B≈ÇƒÖd", "B≈ÇƒÖd odtwarzania d≈∫wiƒôku. Sprawd≈∫ uprawnienia przeglƒÖdarki.");
                    });
                    
                    // Dodaj d≈∫wiƒôk do aktywnych
                    activeSounds.set(soundName, audio);
                    
                    // Dodaj klasƒô active do przycisku
                    document.querySelector(`.sound-btn[data-sound="${soundName}"]`).classList.add('active');
                    
                    // Dodaj kartƒô d≈∫wiƒôku do kontenera
                    const soundCard = createSoundCard(soundName, audio);
                    activeContainer.appendChild(soundCard);
                    
                } catch (error) {
                    showToast("B≈ÇƒÖd", "WystƒÖpi≈Ç nieoczekiwany b≈ÇƒÖd podczas odtwarzania d≈∫wiƒôku");
                }
            }
            
            // Zatrzymanie pojedynczego d≈∫wiƒôku
            function stopSound(soundName) {
                if (activeSounds.has(soundName)) {
                    const audio = activeSounds.get(soundName);
                    audio.pause();
                    audio.currentTime = 0;
                    activeSounds.delete(soundName);
                    
                    // Usu≈Ñ klasƒô active z przycisku
                    const button = document.querySelector(`.sound-btn[data-sound="${soundName}"]`);
                    if (button) button.classList.remove('active');
                    
                    // Usu≈Ñ kartƒô d≈∫wiƒôku
                    const card = document.querySelector(`.sound-card[data-sound="${soundName}"]`);
                    if (card) card.remove();
                }
            }
            
            // Zatrzymanie wszystkich d≈∫wiƒôk√≥w
            function stopAllSounds() {
                for (const [soundName, audio] of activeSounds.entries()) {
                    audio.pause();
                    audio.currentTime = 0;
                    
                    // Usu≈Ñ klasƒô active z przycisku
                    const button = document.querySelector(`.sound-btn[data-sound="${soundName}"]`);
                    if (button) button.classList.remove('active');
                }
                
                activeSounds.clear();
                activeContainer.innerHTML = '';
            }
            
            // Funkcja do p≈Çynnego wyciszania d≈∫wiƒôk√≥w
            function fadeOutAllSounds(duration = 3000) {
                // Zapisz poczƒÖtkowe g≈Ço≈õno≈õci dla ka≈ºdego d≈∫wiƒôku
                const initialVolumes = new Map();
                for (const [soundName, audio] of activeSounds.entries()) {
                    initialVolumes.set(soundName, audio.volume);
                }
                
                const startTime = Date.now();
                const fadeInterval = setInterval(() => {
                    const elapsed = Date.now() - startTime;
                    const ratio = 1 - Math.min(elapsed / duration, 1);
                    
                    // Aktualizuj g≈Ço≈õno≈õƒá ka≈ºdego d≈∫wiƒôku
                    for (const [soundName, audio] of activeSounds.entries()) {
                        audio.volume = initialVolumes.get(soundName) * ratio;
                    }
                    
                    // Zatrzymaj interwa≈Ç i d≈∫wiƒôki po zako≈Ñczeniu wyciszania
                    if (elapsed >= duration) {
                        clearInterval(fadeInterval);
                        stopAllSounds();
                    }
                }, 50);
            }
            
            // Ustawienie timera
            function setTimer(minutes) {
                // Wyczyszczenie istniejƒÖcego timera
                clearInterval(timerInterval);
                
                // Usuniƒôcie klasy active ze wszystkich przycisk√≥w timera
                timerButtons.forEach(btn => btn.classList.remove('active'));
                
                // Je≈õli minutes wynosi 0, wyczy≈õƒá timer
                if (minutes === 0) {
                    timerDisplay.textContent = '00:00:00';
                    timerEndTime = null;
                    return;
                }
                
                // Aktywuj przycisk timera je≈õli jest standardowym timerem
                const timerBtn = document.querySelector(`.timer-btn[data-time="${minutes}"]`);
                if (timerBtn) {
                    timerBtn.classList.add('active');
                }
                
                // Oblicz czas zako≈Ñczenia
                const now = new Date();
                timerEndTime = new Date(now.getTime() + minutes * 60000);
                
                // Natychmiast aktualizuj wy≈õwietlanie timera
                updateTimerDisplay();
                
                // Ustaw interwa≈Ç do aktualizacji wy≈õwietlania
                timerInterval = setInterval(function() {
                    if (!updateTimerDisplay()) {
                        // Timer zako≈Ñczony
                        clearInterval(timerInterval);
                        
                        // P≈Çynnie wycisz wszystkie d≈∫wiƒôki
                        fadeOutAllSounds(5000);
                        
                        // Usu≈Ñ aktywne klasy z przycisk√≥w timera
                        timerButtons.forEach(btn => btn.classList.remove('active'));
                        
                        // Powiadomienie
                        showToast('Timer zako≈Ñczony', 'D≈∫wiƒôki zosta≈Çy p≈Çynnie wyciszone.');
                        
                        // Powiadomienie przeglƒÖdarki (opcjonalnie)
                        if ('Notification' in window && Notification.permission === 'granted') {
                            new Notification('≈öpij S≈Çoneczko', {
                                body: 'Timer zako≈Ñczony. D≈∫wiƒôki zosta≈Çy wyciszone.',
                                icon: '/favicon.ico'
                            });
                        }
                    }
                }, 1000);
                
                // Poka≈º powiadomienie o ustawieniu timera
                showToast('Timer ustawiony', `Timer ustawiony na ${minutes} minut.`);
            }
            
            // Aktualizacja wy≈õwietlania timera
            function updateTimerDisplay() {
                if (!timerEndTime) return false;
                
                const now = new Date();
                const diff = timerEndTime - now;
                
                // Je≈õli timer siƒô zako≈Ñczy≈Ç
                if (diff <= 0) {
                    timerDisplay.textContent = '00:00:00';
                    return false;
                }
                
                // Oblicz godziny, minuty, sekundy
                const hours = Math.floor(diff / 3600000);
                const minutes = Math.floor((diff % 3600000) / 60000);
                const seconds = Math.floor((diff % 60000) / 1000);
                
                // Formatuj wy≈õwietlanie
                timerDisplay.textContent = 
                    `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                return true;
            }
            
            // =========== ROZBUDOWANE ƒÜWICZENIA RELAKSACYJNE ===========
            // Zmienne dla ƒáwicze≈Ñ oddechowych
            const breathingCircle = document.getElementById('breathing-circle');
            const breathingText = document.getElementById('breathing-text');
            const breathingDescription = document.getElementById('breathing-description');
            const startBreathingBtn = document.getElementById('start-breathing-btn');
            let breathingInterval = null;
            let currentBreathingType = '478'; // domy≈õlnie 4-7-8
            
            // Definicje ƒáwicze≈Ñ oddechowych
            const breathingTypes = {
                '478': {
                    description: 'Technika 4-7-8 pomaga zrelaksowaƒá siƒô i przygotowaƒá do snu',
                    phases: [
                        { name: 'inhale', text: 'Wdech', duration: 4000 },
                        { name: 'hold', text: 'Zatrzymaj', duration: 7000 },
                        { name: 'exhale', text: 'Wydech', duration: 8000 }
                    ]
                },
                'box': {
                    description: 'Oddychanie kwadratowe 4-4-4-4 pomaga uspokoiƒá umys≈Ç i znale≈∫ƒá r√≥wnowagƒô',
                    phases: [
                        { name: 'box-inhale', text: 'Wdech', duration: 4000 },
                        { name: 'box-hold1', text: 'Zatrzymaj', duration: 4000 },
                        { name: 'box-exhale', text: 'Wydech', duration: 4000 },
                        { name: 'box-hold2', text: 'Zatrzymaj', duration: 4000 }
                    ]
                },
                'diaphragm': {
                    description: 'Oddychanie przeponowe g≈Çƒôboko dotlenia organizm i pomaga siƒô zrelaksowaƒá',
                    phases: [
                        { name: 'inhale', text: 'G≈Çƒôboki wdech przeponƒÖ', duration: 5000 },
                        { name: 'exhale', text: 'Powolny, pe≈Çny wydech', duration: 7000 }
                    ]
                }
            };
            
            // Funkcja rozpoczynajƒÖca ƒáwiczenie oddechowe
            function startBreathingExercise() {
                // Zatrzymaj istniejƒÖcy interwa≈Ç je≈õli istnieje
                if (breathingInterval) {
                    clearInterval(breathingInterval);
                    breathingCircle.className = 'breathing-circle';
                    breathingText.textContent = 'Kliknij, aby rozpoczƒÖƒá';
                    startBreathingBtn.textContent = 'Rozpocznij ƒáwiczenie';
                    return;
                }
                
                const exerciseConfig = breathingTypes[currentBreathingType];
                let phase = 0;
                const phases = exerciseConfig.phases;
                
                function updateBreathingPhase() {
                    const currentPhase = phases[phase];
                    
                    // Usu≈Ñ wszystkie klasy animacji
                    breathingCircle.className = 'breathing-circle';
                    
                    // Dodaj nowƒÖ klasƒô animacji
                    setTimeout(() => {
                        breathingCircle.classList.add(currentPhase.name);
                        breathingText.textContent = currentPhase.text;
                    }, 10);
                    
                    // Przejd≈∫ do nastƒôpnej fazy
                    phase = (phase + 1) % phases.length;
                    
                    // Ustaw timeout dla nastƒôpnej fazy
                    breathingInterval = setTimeout(updateBreathingPhase, currentPhase.duration);
                }
                
                // Rozpocznij od pierwszej fazy
                updateBreathingPhase();
                
                // Zmie≈Ñ tekst przycisku
                startBreathingBtn.textContent = 'Zatrzymaj ƒáwiczenie';
            }
            
            // Obs≈Çuga przycisk√≥w wyboru techniki oddechowej
            document.querySelectorAll('.exercise-tab[data-breathing]').forEach(tab => {
                tab.addEventListener('click', function() {
                    // Zatrzymaj aktualne ƒáwiczenie
                    if (breathingInterval) {
                        clearInterval(breathingInterval);
                        breathingInterval = null;
                        breathingCircle.className = 'breathing-circle';
                        breathingText.textContent = 'Kliknij, aby rozpoczƒÖƒá';
                        startBreathingBtn.textContent = 'Rozpocznij ƒáwiczenie';
                    }
                    
                    // Ustaw nowy typ oddychania
                    currentBreathingType = this.dataset.breathing;
                    
                    // Aktualizuj opis
                    breathingDescription.textContent = breathingTypes[currentBreathingType].description;
                    
                    // Aktualizuj aktywny przycisk
                    document.querySelectorAll('.exercise-tab[data-breathing]').forEach(t => {
                        t.classList.remove('active');
                    });
                    this.classList.add('active');
                });
            });
            
            // Obs≈Çuga przycisku ƒáwiczenia oddechowego
            startBreathingBtn.addEventListener('click', function() {
                if (this.textContent.includes('Rozpocznij')) {
                    startBreathingExercise();
                } else {
                    if (breathingInterval) {
                        clearInterval(breathingInterval);
                        breathingInterval = null;
                    }
                    breathingCircle.className = 'breathing-circle';
                    breathingText.textContent = 'Kliknij, aby rozpoczƒÖƒá';
                    this.textContent = 'Rozpocznij ƒáwiczenie';
                }
            });
            
            // Umo≈ºliwienie klikniƒôcia bezpo≈õrednio na k√≥≈Çko
            breathingCircle.addEventListener('click', function() {
                startBreathingBtn.click();
            });
            
            // =========== PROGRESYWNA RELAKSACJA MIƒò≈öNI ===========
            const muscleGroups = document.querySelectorAll('.muscle-group');
            const startMuscleBtn = document.getElementById('start-muscle-relaxation');
            const muscleProgress = document.getElementById('muscle-progress');
            let muscleRelaxationInterval = null;
            let currentMuscleGroup = 0;
            
            // Obs≈Çuga klikniƒôƒá w grupy miƒô≈õniowe
            muscleGroups.forEach(group => {
                group.addEventListener('click', function() {
                    // Prze≈ÇƒÖcz widoczno≈õƒá instrukcji
                    const instruction = this.querySelector('.muscle-instruction');
                    instruction.classList.toggle('visible');
                    
                    // Prze≈ÇƒÖcz stan aktywny grupy
                    this.classList.toggle('active');
                });
            });
            
            // Funkcja prowadzƒÖca przez pe≈Çne ƒáwiczenie relaksacji miƒô≈õniowej
            function startMuscleRelaxation() {
                // Zatrzymanie istniejƒÖcego ƒáwiczenia
                if (muscleRelaxationInterval) {
                    clearInterval(muscleRelaxationInterval);
                    muscleRelaxationInterval = null;
                    startMuscleBtn.textContent = 'Rozpocznij pe≈Çne ƒáwiczenie';
                    muscleGroups.forEach(group => {
                        group.classList.remove('active');
                        group.querySelector('.muscle-instruction').classList.remove('visible');
                    });
                    muscleProgress.style.width = '0%';
                    return;
                }
                
                // Przygotuj wszystkie grupy
                muscleGroups.forEach(group => {
                    group.classList.remove('active');
                    group.querySelector('.muscle-instruction').classList.remove('visible');
                });
                
                currentMuscleGroup = 0;
                startMuscleBtn.textContent = 'Zatrzymaj ƒáwiczenie';
                
                // Funkcja przechodzƒÖca przez poszczeg√≥lne grupy miƒô≈õniowe
                function goToNextMuscleGroup() {
                    // Zako≈Ñcz ƒáwiczenie po przej≈õciu przez wszystkie grupy
                    if (currentMuscleGroup >= muscleGroups.length) {
                        clearInterval(muscleRelaxationInterval);
                        muscleRelaxationInterval = null;
                        startMuscleBtn.textContent = 'Rozpocznij pe≈Çne ƒáwiczenie';
                        
                        // Poka≈º powiadomienie o zako≈Ñczeniu
                        showToast('ƒÜwiczenie zako≈Ñczone', 'Gratulacje! Uko≈Ñczy≈Çe≈õ/a≈õ ƒáwiczenie relaksacji miƒô≈õni.');
                        
                        // Resetuj grupy miƒô≈õniowe
                        muscleGroups.forEach(group => {
                            group.classList.remove('active');
                            group.querySelector('.muscle-instruction').classList.remove('visible');
                        });
                        return;
                    }
                    
                    // Aktualizuj pasek postƒôpu
                    const progressPercentage = (currentMuscleGroup / muscleGroups.length) * 100;
                    muscleProgress.style.width = `${progressPercentage}%`;
                    
                    // Usu≈Ñ aktywnƒÖ klasƒô ze wszystkich grup
                    muscleGroups.forEach(group => {
                        group.classList.remove('active');
                        group.querySelector('.muscle-instruction').classList.remove('visible');
                    });
                    
                    // Aktywuj bie≈ºƒÖcƒÖ grupƒô
                    const currentGroup = muscleGroups[currentMuscleGroup];
                    currentGroup.classList.add('active');
                    currentGroup.querySelector('.muscle-instruction').classList.add('visible');
                    
                    // Przewi≈Ñ do aktywnej grupy
                    currentGroup.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    
                    // Przejd≈∫ do nastƒôpnej grupy po 20 sekundach (5s napiƒôcie + 15s relaks)
                    currentMuscleGroup++;
                    
                    // Poka≈º powiadomienie
                    if (currentMuscleGroup <= muscleGroups.length) {
                        const groupName = currentGroup.querySelector('h4').textContent;
                        showToast('Grupa miƒô≈õniowa', groupName);
                    }
                }
                
                // Rozpocznij od pierwszej grupy
                goToNextMuscleGroup();
                
                // Ustaw interwa≈Ç 20 sekund miƒôdzy grupami
                muscleRelaxationInterval = setInterval(goToNextMuscleGroup, 20000);
            }
            
            // Obs≈Çuga przycisku rozpoczƒôcia ƒáwiczenia relaksacji miƒô≈õni
            startMuscleBtn.addEventListener('click', startMuscleRelaxation);
            
            // =========== WIZUALIZACJE RELAKSACYJNE ===========
            const visualizationScene = document.getElementById('visualization-scene');
            const visualizationText = document.getElementById('visualization-text');
            const startVisualizationBtn = document.getElementById('start-visualization');
            let visualizationInterval = null;
            let currentScene = 'beach'; // domy≈õlna scena
            
            // Teksty dla r√≥≈ºnych scen wizualizacji
            const visualizationScenes = {
                'beach': [
                    'Wyobra≈∫ sobie, ≈ºe le≈ºysz na ciep≈Çej, miƒôkkiej pla≈ºy. Czujesz delikatne ciep≈Ço s≈Ço≈Ñca na swojej sk√≥rze.',
                    'Fale rytmicznie uderzajƒÖ o brzeg, tworzƒÖc uspokajajƒÖcy szum. Wdychasz ≈õwie≈ºy, morski zapach.',
                    'Z ka≈ºdym oddechem czujesz siƒô coraz bardziej zrelaksowany/a. Twoje cia≈Ço powoli zanurza siƒô w miƒôkkim piasku.',
                    'Niebo nad tobƒÖ jest b≈Çƒôkitne, z kilkoma puszystymi chmurami. S≈Çyszysz odleg≈Çe krzyki mew.',
                    'Twoje miƒô≈õnie siƒô rozlu≈∫niajƒÖ, a umys≈Ç uspokaja. Pozw√≥l sobie na ca≈Çkowite odprƒô≈ºenie w tym spokojnym miejscu.'
                ],
                'forest': [
                    'Znajdujesz siƒô w piƒôknym, starym lesie. OtaczajƒÖ ciƒô wysokie drzewa, a ich li≈õcie szumiƒÖ delikatnie na wietrze.',
                    'Promienie s≈Ço≈Ñca przebijajƒÖ siƒô przez korony drzew, tworzƒÖc ciep≈Çe plamy ≈õwiat≈Ça na ≈õcie≈ºce przed tobƒÖ.',
                    'S≈Çyszysz ≈õpiew ptak√≥w i delikatny szelest li≈õci. Powietrze jest ≈õwie≈ºe i pe≈Çne zapachu ≈ºywicy.',
                    'Z ka≈ºdym krokiem zag≈Çƒôbiasz siƒô dalej w las, czujƒÖc spok√≥j i harmoniƒô tego miejsca.',
                    'Znajdujesz miƒôkkie, mchowe miejsce, gdzie mo≈ºesz usiƒÖ≈õƒá lub po≈Ço≈ºyƒá siƒô. Czujesz, jak ca≈Çy stres opuszcza twoje cia≈Ço.'
                ],
                'sky': [
                    'Le≈ºysz na miƒôkkim kocu i patrzysz w nocne niebo pe≈Çne gwiazd. Nad tobƒÖ rozciƒÖga siƒô niesko≈Ñczony kosmos.',
                    'Gwiazdy migoczƒÖ delikatnie, a ty dostrzegasz znane konstelacje i jasny sierp ksiƒô≈ºyca.',
                    'Powietrze jest ch≈Çodne i rze≈õkie. Z ka≈ºdym oddechem czujesz, jak tw√≥j umys≈Ç siƒô uspokaja.',
                    'Twoje cia≈Ço staje siƒô lekkie, niemal jakby≈õ m√≥g≈Ç/mog≈Ça unosiƒá siƒô w≈õr√≥d gwiazd. Grawitacja zdaje siƒô s≈ÇabnƒÖƒá.',
                    'Problemy i zmartwienia malejƒÖ, stajƒÖ siƒô ma≈Çe jak drobne punkty na niebie. Czujesz g≈Çƒôboki spok√≥j i po≈ÇƒÖczenie z wszech≈õwiatem.'
                ]
            };
            
            // Funkcja zmieniajƒÖca scenƒô wizualizacji
            function changeVisualizationScene(sceneName) {
                visualizationScene.className = 'visualization-scene';
                visualizationScene.classList.add(`visualization-${sceneName}`);
                
                // Dodaj lub usu≈Ñ elementy specyficzne dla sceny
                visualizationScene.innerHTML = '';
                
                if (sceneName === 'beach') {
                    // Dodaj fale dla pla≈ºy
                    for (let i = 0; i < 3; i++) {
                        const wave = document.createElement('div');
                        wave.className = 'wave';
                        visualizationScene.appendChild(wave);
                    }
                }
                
                // Dodaj overlay z tekstem
                const overlay = document.createElement('div');
                overlay.className = 'visualization-overlay';
                overlay.innerHTML = `<p class="visualization-text" id="visualization-text">${visualizationScenes[sceneName][0]}</p>`;
                visualizationScene.appendChild(overlay);
                
                // Aktualizuj referencjƒô do elementu tekstu
                visualizationText = document.getElementById('visualization-text');
            }
            
            // Funkcja rozpoczynajƒÖca wizualizacjƒô
            function startVisualization() {
                // Zatrzymaj istniejƒÖcƒÖ wizualizacjƒô je≈õli istnieje
                if (visualizationInterval) {
                    clearInterval(visualizationInterval);
                    visualizationInterval = null;
                    startVisualizationBtn.textContent = 'Rozpocznij wizualizacjƒô';
                    return;
                }
                
                startVisualizationBtn.textContent = 'Zatrzymaj wizualizacjƒô';
                
                let currentTextIndex = 0;
                const texts = visualizationScenes[currentScene];
                
                // Funkcja aktualizujƒÖca tekst wizualizacji
                function updateVisualizationText() {
                    // P≈Çynna zmiana tekstu
                    visualizationText.style.opacity = '0';
                    
                    setTimeout(() => {
                        visualizationText.textContent = texts[currentTextIndex];
                        visualizationText.style.opacity = '1';
                        
                        // Przejd≈∫ do nastƒôpnego tekstu
                        currentTextIndex = (currentTextIndex + 1) % texts.length;
                    }, 500);
                }
                
                // Rozpocznij od pierwszego tekstu
                updateVisualizationText();
                
                // Ustaw interwa≈Ç do zmiany tekst√≥w co 10 sekund
                visualizationInterval = setInterval(updateVisualizationText, 10000);
            }
            
            // Obs≈Çuga przycisk√≥w wyboru sceny wizualizacji
            document.querySelectorAll('.exercise-tab[data-scene]').forEach(tab => {
                tab.addEventListener('click', function() {
                    // Zatrzymaj aktualnƒÖ wizualizacjƒô
                    if (visualizationInterval) {
                        clearInterval(visualizationInterval);
                        visualizationInterval = null;
                        startVisualizationBtn.textContent = 'Rozpocznij wizualizacjƒô';
                    }
                    
                    // Ustaw nowƒÖ scenƒô
                    currentScene = this.dataset.scene;
                    changeVisualizationScene(currentScene);
                    
                    // Aktualizuj aktywny przycisk
                    document.querySelectorAll('.exercise-tab[data-scene]').forEach(t => {
                        t.classList.remove('active');
                    });
                    this.classList.add('active');
                });
            });
            
            // Obs≈Çuga przycisku rozpoczƒôcia wizualizacji
            startVisualizationBtn.addEventListener('click', startVisualization);
            
            // Obs≈Çuga g≈Ç√≥wnych zak≈Çadek ƒáwicze≈Ñ
            document.querySelectorAll('.exercise-tab[data-tab]').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.dataset.tab;
                    
                    // Ukryj wszystkie tre≈õci ƒáwicze≈Ñ
                    document.querySelectorAll('.exercise-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // Poka≈º wybranƒÖ tre≈õƒá
                    document.getElementById(`${tabName}-content`).classList.add('active');
                    
                    // Aktualizuj aktywny przycisk
                    document.querySelectorAll('.exercise-tab[data-tab]').forEach(t => {
                        t.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // Zatrzymaj wszystkie aktywne ƒáwiczenia
                    if (breathingInterval) {
                        clearInterval(breathingInterval);
                        breathingInterval = null;
                        breathingCircle.className = 'breathing-circle';
                        breathingText.textContent = 'Kliknij, aby rozpoczƒÖƒá';
                        startBreathingBtn.textContent = 'Rozpocznij ƒáwiczenie';
                    }
                    
                    if (muscleRelaxationInterval) {
                        clearInterval(muscleRelaxationInterval);
                        muscleRelaxationInterval = null;
                        startMuscleBtn.textContent = 'Rozpocznij pe≈Çne ƒáwiczenie';
                        muscleGroups.forEach(group => {
                            group.classList.remove('active');
                            group.querySelector('.muscle-instruction').classList.remove('visible');
                        });
                        muscleProgress.style.width = '0%';
                    }
                    
                    if (visualizationInterval) {
                        clearInterval(visualizationInterval);
                        visualizationInterval = null;
                        startVisualizationBtn.textContent = 'Rozpocznij wizualizacjƒô';
                    }
                });
            });
            
            // =========== NAS≈ÅUCHIWACZE ZDARZE≈É ===========
            
            // Nas≈Çuchiwacze zdarze≈Ñ dla przycisk√≥w d≈∫wiƒôku
            soundButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const soundName = this.dataset.sound;
                    playSound(soundName);
                });
            });
            
            // Nas≈Çuchiwacze zdarze≈Ñ dla suwaka g≈Ço≈õno≈õci g≈Ç√≥wnej
            volumeSlider.addEventListener('input', function() {
                const value = parseFloat(this.value);
                for (const audio of activeSounds.values()) {
                    audio.volume = value;
                }
                
                // Aktualizuj wszystkie suwaki indywidualnej g≈Ço≈õno≈õci
                document.querySelectorAll('.individual-volume').forEach(slider => {
                    slider.value = value;
                });
            });
            
            // Nas≈Çuchiwacze zdarze≈Ñ dla przycisk√≥w timera
            timerButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const minutes = parseInt(this.dataset.time);
                    setTimer(minutes);
                });
            });
            
            // Nas≈Çuchiwacz dla niestandardowego timera
            customTimerBtn.addEventListener('click', function() {
                const minutes = parseInt(customTimerInput.value);
                if (isNaN(minutes) || minutes <= 0 || minutes > 480) {
                    showToast('B≈ÇƒÖd', 'Wprowad≈∫ warto≈õƒá miƒôdzy 1 a 480 minut.');
                    return;
                }
                setTimer(minutes);
                
                // Wyczy≈õƒá pole input
                customTimerInput.value = '';
            });
            
            // Obs≈Çuga Enter w polu niestandardowego timera
            customTimerInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    customTimerBtn.click();
                }
            });
            
            // Obs≈Çuga zapisywania preferencji
            document.getElementById('save-preferences').addEventListener('click', function(e) {
                e.preventDefault();
                
                // Zapisz preferencje w localStorage
                const preferences = {
                    volume: volumeSlider.value,
                    theme: document.body.classList.contains('light-mode') ? 'light' : 'dark',
                    activeSounds: Array.from(activeSounds.keys())
                };
                
                localStorage.setItem('spijSloneczko-preferences', JSON.stringify(preferences));
                showToast('Zapisano', 'Twoje preferencje zosta≈Çy zapisane!');
            });
            
            // ≈Åadowanie zapisanych preferencji
            function loadSavedPreferences() {
                const savedPrefs = localStorage.getItem('spijSloneczko-preferences');
                if (!savedPrefs) return;
                
                try {
                    const preferences = JSON.parse(savedPrefs);
                    
                    // Ustaw g≈Ço≈õno≈õƒá
                    if (preferences.volume) {
                        volumeSlider.value = preferences.volume;
                    }
                    
                    // Ustaw motyw (ju≈º obs≈Çu≈ºone wcze≈õniej)
                    
                    // Odtw√≥rz zapisane d≈∫wiƒôki
                    if (preferences.activeSounds && Array.isArray(preferences.activeSounds)) {
                        preferences.activeSounds.forEach(sound => {
                            setTimeout(() => {
                                playSound(sound);
                            }, 500);
                        });
                    }
                    
                } catch (error) {
                    console.error('B≈ÇƒÖd podczas wczytywania preferencji:', error);
                }
            }
            
            // Sprawdzenie dostƒôpno≈õci plik√≥w d≈∫wiƒôkowych
            function checkSoundFiles() {
                Object.entries(sounds).forEach(([name, path]) => {
                    const testAudio = new Audio();
                    testAudio.addEventListener('error', () => {
                        console.warn(`Plik d≈∫wiƒôkowy "${path}" dla "${name}" nie zosta≈Ç znaleziony.`);
                    });
                    testAudio.src = path;
                });
            }
            
            // Zapytanie o pozwolenie na powiadomienia
            if ('Notification' in window && Notification.permission !== 'granted' && Notification.permission !== 'denied') {
                Notification.requestPermission();
            }
            
            // Wczytaj preferencje po za≈Çadowaniu strony
            setTimeout(() => {
                loadSavedPreferences();
                checkSoundFiles();
            }, 1000);
        });
    </script>
</body>
</html>